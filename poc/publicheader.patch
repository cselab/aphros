diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index c86441f0..2ffac089 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -26,9 +26,14 @@ add_custom_target(gitrev
 
 include_directories(.)
 
+include(header.cmake)
+
 function(add_library name)
   _add_library(${name} ${ARGN})
-  install(TARGETS ${name} EXPORT export DESTINATION ${CHPREFIX}/lib)
+  set_target_properties(${name} PROPERTIES PUBLIC_HEADER "${HH}")
+  install(TARGETS ${name} 
+      EXPORT export DESTINATION ${CHPREFIX}/lib
+      PUBLIC_HEADER DESTINATION ${CHPREFIX}/include)
   target_include_directories(${name} INTERFACE "${CHPREFIX}/include/hydro")
 endfunction(add_library)
 
@@ -41,6 +46,7 @@ add_subdirectory(dump)
 add_subdirectory(overlap)
 add_subdirectory(young)
 
+
 # hydro
 set(T "hydro")
 add_library(${T} INTERFACE)
@@ -48,6 +54,7 @@ set_property(TARGET ${T} APPEND PROPERTY INTERFACE_INCLUDE_DIRECTORIES
     "${CHPREFIX}/include/hydro")
 set_property(TARGET ${T} APPEND PROPERTY INTERFACE_LINK_LIBRARIES 
     distr solver vof tvd convdiffvi simple overlap young utilfluid events)
+set_target_properties(${T} PROPERTIES PUBLIC_HEADER "${HH}")
 
 # binary
 add_executable(${EXE} main.cpp)
@@ -61,4 +68,4 @@ enable_testing()
 
 install(EXPORT export FILE export.cmake DESTINATION ${CHPREFIX}/include)
 install(FILES client.cmake hydro.cmake DESTINATION ${CHPREFIX}/include)
-include(header.cmake)
+
diff --git a/src/header.cmake b/src/header.cmake
index ee97683e..3fc7bbf1 100644
--- a/src/header.cmake
+++ b/src/header.cmake
@@ -1,92 +1,148 @@
 # generated by ../tool/header
-install(FILES Cubism/BlockInfo.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/BlockLab.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/BlockLabMPI.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/DependencyCubeMPI.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/Grid.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/GridMPI.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/HDF5Dumper_MPI.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/Matrix3D.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/MeshMap.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/PUPkernelsMPI.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/QPXEMU.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/StencilInfo.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES Cubism/SynchronizerMPI.h DESTINATION ${CHPREFIX}/include/hydro/Cubism)
-install(FILES debug/isnan.h DESTINATION ${CHPREFIX}/include/hydro/debug)
-install(FILES distr/cubism.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES distr/distr.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES distr/distrsolver.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES distr/icubism.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES distr/ilocal.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES distr/local.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES distr/reduce.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES distr/report.h DESTINATION ${CHPREFIX}/include/hydro/distr)
-install(FILES dump/dump.h DESTINATION ${CHPREFIX}/include/hydro/dump)
-install(FILES dump/dumper.h DESTINATION ${CHPREFIX}/include/hydro/dump)
-install(FILES dump/output.h DESTINATION ${CHPREFIX}/include/hydro/dump)
-install(FILES dump/output_paraview.h DESTINATION ${CHPREFIX}/include/hydro/dump)
-install(FILES dump/vtk.h DESTINATION ${CHPREFIX}/include/hydro/dump)
-install(FILES func/init_cl.h DESTINATION ${CHPREFIX}/include/hydro/func)
-install(FILES func/init_sig.h DESTINATION ${CHPREFIX}/include/hydro/func)
-install(FILES func/init_u.h DESTINATION ${CHPREFIX}/include/hydro/func)
-install(FILES func/init_vel.h DESTINATION ${CHPREFIX}/include/hydro/func)
-install(FILES geom/block.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/blockface.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/blockfaced.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/dir.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/field.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/idx.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/map.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/mesh.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/range.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/rangein.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES geom/vect.h DESTINATION ${CHPREFIX}/include/hydro/geom)
-install(FILES kernel/hydro.h DESTINATION ${CHPREFIX}/include/hydro/kernel)
-install(FILES kernel/kernel.h DESTINATION ${CHPREFIX}/include/hydro/kernel)
-install(FILES kernel/kernelmesh.h DESTINATION ${CHPREFIX}/include/hydro/kernel)
-install(FILES kernel/kernelmeshpar.h DESTINATION ${CHPREFIX}/include/hydro/kernel)
-install(FILES linear/hypre.h DESTINATION ${CHPREFIX}/include/hydro/linear)
-install(FILES linear/linear.h DESTINATION ${CHPREFIX}/include/hydro/linear)
-install(FILES overlap/overlap.h DESTINATION ${CHPREFIX}/include/hydro/overlap)
-install(FILES parse/parser.h DESTINATION ${CHPREFIX}/include/hydro/parse)
-install(FILES parse/simple.h DESTINATION ${CHPREFIX}/include/hydro/parse)
-install(FILES parse/tvd.h DESTINATION ${CHPREFIX}/include/hydro/parse)
-install(FILES parse/util.h DESTINATION ${CHPREFIX}/include/hydro/parse)
-install(FILES parse/vars.h DESTINATION ${CHPREFIX}/include/hydro/parse)
-install(FILES parse/vof.h DESTINATION ${CHPREFIX}/include/hydro/parse)
-install(FILES solver/advection.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/approx.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/cond.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/convdiff.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/convdiffe.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/convdiffi.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/convdiffv.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/convdiffvi.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/embed.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/fluid.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/normal.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/partstr.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/partstrmesh.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/pois.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/reconst.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/simple.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/solver.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/sphavg.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/tracker.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/tvd.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES solver/vof.h DESTINATION ${CHPREFIX}/include/hydro/solver)
-install(FILES test/advection/cmp.h DESTINATION ${CHPREFIX}/include/hydro/test)
-install(FILES test/advection/trash/gerris_k/ini_t_bub.h DESTINATION ${CHPREFIX}/include/hydro/test)
-install(FILES test/basilisk/chpartstr.h DESTINATION ${CHPREFIX}/include/hydro/test)
-install(FILES test/basilisk/curvature.h DESTINATION ${CHPREFIX}/include/hydro/test)
-install(FILES test/basilisk/fractions.h DESTINATION ${CHPREFIX}/include/hydro/test)
-install(FILES util/convdiff.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/events.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/fluid.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/git.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/height.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/metrics.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/suspender.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/sysinfo.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES util/timer.h DESTINATION ${CHPREFIX}/include/hydro/util)
-install(FILES young/young.h DESTINATION ${CHPREFIX}/include/hydro/young)
+set(HH
+Cubism/GridMPI.h
+Cubism/BlockLabMPI.h
+Cubism/Matrix3D.h
+Cubism/StencilInfo.h
+Cubism/SynchronizerMPI.h
+Cubism/Grid.h
+Cubism/MeshMap.h
+Cubism/DependencyCubeMPI.h
+Cubism/PUPkernelsMPI.h
+Cubism/QPXEMU.h
+Cubism/BlockInfo.h
+Cubism/HDF5Dumper_MPI.h
+Cubism/BlockLab.h
+dump/output_paraview.h
+dump/output.h
+dump/dump.h
+dump/vtk.h
+dump/dumper.h
+parse/vof.h
+parse/simple.h
+parse/parser.h
+parse/util.h
+parse/vars.h
+parse/tvd.h
+overlap/overlap.h
+kernel/kernelmeshpar.h
+kernel/kernel.h
+kernel/hydro.h
+kernel/kernelmesh.h
+young/young.h
+func/init_cl.h
+func/init_u.h
+func/init_sig.h
+func/init_vel.h
+solver/tracker.h
+solver/vof.h
+solver/simple.h
+solver/convdiffv.h
+solver/pois.h
+solver/embed.h
+solver/convdiff.h
+solver/fluid.h
+solver/solver.h
+solver/sphavg.h
+solver/partstr.h
+solver/cond.h
+solver/convdiffe.h
+solver/approx.h
+solver/convdiffvi.h
+solver/advection.h
+solver/normal.h
+solver/reconst.h
+solver/partstrmesh.h
+solver/tvd.h
+solver/convdiffi.h
+geom/rangein.h
+geom/field.h
+geom/blockfaced.h
+geom/vect.h
+geom/block.h
+geom/range.h
+geom/idx.h
+geom/mesh.h
+geom/dir.h
+geom/blockface.h
+geom/map.h
+test/randc/dim2_overlap1/ba/curvature_partstr.h
+test/randc/dim2_overlap1/ba/curvature_fix.h
+test/randc/dim2_overlap1/ba/curvature_select.h
+test/randc/dim2_overlap1/ba/curvature_div.h
+test/randc/dim2_overlap1/ba/io/util.h
+test/randc/dim2_overlap1/ba/io/3d.h
+test/randc/dim2_overlap1/ba/io/write.h
+test/randc/dim2_overlap1/ba/io/iompi.h
+test/randc/dim2_overlap1/ba/io/2d.h
+test/randc/dim2_overlap1/ba/io/io.h
+test/randc/dim2_overlap1/ba/curvature_zero.h
+test/randc/dim2_overlap1/ba/learn.h
+test/randc/dim2_overlap1/ba/curvature_learn.h
+test/randc/dim2_overlap1/ge/ini_t_bub.h
+test/randc/dim2_overlap1/ge/ini_dat.h
+test/randc/dim2_overlap1/bad/curvature_partstr.h
+test/randc/dim2_overlap1/bad/curvature_fix.h
+test/randc/dim2_overlap1/bad/curvature_select.h
+test/randc/dim2_overlap1/bad/curvature_div.h
+test/randc/dim2_overlap1/bad/io/util.h
+test/randc/dim2_overlap1/bad/io/3d.h
+test/randc/dim2_overlap1/bad/io/write.h
+test/randc/dim2_overlap1/bad/io/iompi.h
+test/randc/dim2_overlap1/bad/io/2d.h
+test/randc/dim2_overlap1/bad/io/io.h
+test/randc/dim2_overlap1/bad/curvature_zero.h
+test/randc/dim2_overlap1/bad/learn.h
+test/randc/dim2_overlap1/bad/curvature_learn.h
+test/randc/dim2_overlap1/bal/curvature_partstr.h
+test/randc/dim2_overlap1/bal/curvature_fix.h
+test/randc/dim2_overlap1/bal/curvature_select.h
+test/randc/dim2_overlap1/bal/curvature_div.h
+test/randc/dim2_overlap1/bal/io/util.h
+test/randc/dim2_overlap1/bal/io/3d.h
+test/randc/dim2_overlap1/bal/io/write.h
+test/randc/dim2_overlap1/bal/io/iompi.h
+test/randc/dim2_overlap1/bal/io/2d.h
+test/randc/dim2_overlap1/bal/io/io.h
+test/randc/dim2_overlap1/bal/curvature_zero.h
+test/randc/dim2_overlap1/bal/learn.h
+test/randc/dim2_overlap1/bal/curvature_learn.h
+test/randc/dim2_overlap1/bap/curvature_partstr.h
+test/randc/dim2_overlap1/bap/curvature_fix.h
+test/randc/dim2_overlap1/bap/curvature_select.h
+test/randc/dim2_overlap1/bap/curvature_div.h
+test/randc/dim2_overlap1/bap/io/util.h
+test/randc/dim2_overlap1/bap/io/3d.h
+test/randc/dim2_overlap1/bap/io/write.h
+test/randc/dim2_overlap1/bap/io/iompi.h
+test/randc/dim2_overlap1/bap/io/2d.h
+test/randc/dim2_overlap1/bap/io/io.h
+test/randc/dim2_overlap1/bap/curvature_zero.h
+test/randc/dim2_overlap1/bap/learn.h
+test/randc/dim2_overlap1/bap/curvature_learn.h
+test/advection/cmp.h
+test/advection/trash/gerris_k/ini_t_bub.h
+test/basilisk/chpartstr.h
+test/basilisk/fractions.h
+test/basilisk/curvature.h
+util/height.h
+util/git.h
+util/convdiff.h
+util/suspender.h
+util/fluid.h
+util/sysinfo.h
+util/metrics.h
+util/timer.h
+util/events.h
+linear/linear.h
+linear/hypre.h
+debug/isnan.h
+distr/report.h
+distr/cubism.h
+distr/distr.h
+distr/ilocal.h
+distr/local.h
+distr/distrsolver.h
+distr/icubism.h
+distr/reduce.h
+)
diff --git a/tool/header b/tool/header
index d27c7ca2..d91aa252 100755
--- a/tool/header
+++ b/tool/header
@@ -2,16 +2,14 @@
 
 find . -type f -name '*.h' |
 awk -v me="$0" '
-BEGIN { print "# generated by " me }
-{   sub(/^\.\//, "")
-    printf "install(FILES %s DESTINATION ${CHPREFIX}/include/hydro/%s)\n",
-	$0, dirname($0)
+BEGIN {
+    print "# generated by " me 
+    print "set(HH"
 }
-
-function dirname(s) {
-    sub(/\/.*/, "", s)
-    return s
+{   sub(/^\.\//, "")
+    print $0
 }
+END { print ")" }
 
 ' > header.cmake
 
