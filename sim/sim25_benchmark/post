#!/bin/bash

suff () {
  case $(hostname) in
    daint*|nid*) echo _daint ;;
    eu-*) echo _euler ;; 
    falcon*) echo _falcon ;; 
    *) echo ;;
  esac
}

o=out_$(date +%Y-%m-%d_%H%M)$(suff)
> "$o"

a () {
  eval "$@" >> "$o"
}

a 'ch.sysinfo'
a 'cat out'

d=history$(cat np)
mkdir -p "$d"
mv -v "$o" "$d"
