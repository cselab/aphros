
#define DIM (27)  // input dimension
#define SW (1)    // stencil half-width
#define H0 (10)
#define H1 (10)
#define HM (27)

#include <tgmath.h>

static double Sig(double x) {
  return 1. / (1. + exp(-x));
}

static double Eval(const double u[]) {
  static const double a0[] = {
    0.19415526092052459717,
    0.074569016695022583008,
    1.1406149864196777344,
    -0.31411772966384887695,
    -7.7136883735656738281,
    -1.0961154699325561523,
    -0.15274891257286071777,
    -34.020572662353515625,
    50.064617156982421875,
    -1.1799830198287963867,
    -2.9607126712799072266,
    13.811553955078125,
    -0.77992892265319824219,
    -9.2642278671264648438,
    -0.52192896604537963867,
    -1.6687879562377929688,
    -13.286647796630859375,
    0.094643771648406982422,
    -2.0137467384338378906,
    -0.078475087881088256836,
    -15.092411041259765625,
    0.55463010072708129883,
    8.2027521133422851562,
    2.2933602333068847656,
    -2.3810701370239257812,
    -13.699980735778808594,
    -9.9144153594970703125,
    0.63789129257202148438,
    0.15005503594875335693,
    -0.20086815953254699707,
    1.3349117040634155273,
    0.70048552751541137695,
    -1.2647383213043212891,
    0.73824125528335571289,
    1.0090123414993286133,
    -0.29877626895904541016,
    -1.2926381826400756836,
    -0.93019694089889526367,
    0.017234861850738525391,
    -4.0095601081848144531,
    -2.8929717540740966797,
    -12.049664497375488281,
    0.95777302980422973633,
    0.4276530146598815918,
    0.94531393051147460938,
    1.9358359575271606445,
    1.777708888053894043,
    0.8526592254638671875,
    -0.11764580756425857544,
    -0.46262589097023010254,
    29.122438430786132812,
    0.27727553248405456543,
    0.40466523170471191406,
    0.023725578561425209045,
    0.87209182977676391602,
    1.4296748638153076172,
    2.0711469650268554688,
    0.61039584875106811523,
    0.79470348358154296875,
    -0.43240836262702941895,
    0.90191882848739624023,
    1.2429709434509277344,
    6.4373340606689453125,
    0.1405639350414276123,
    -1.1460994482040405273,
    -2.6754965782165527344,
    -1.8948415517807006836,
    -1.7939871549606323242,
    -0.32064479589462280273,
    -1.2648172378540039062,
    -1.5163148641586303711,
    -49.678188323974609375,
    0.24107348918914794922,
    1.0793184041976928711,
    1.6886800527572631836,
    -0.095454283058643341064,
    0.61326229572296142578,
    -26.944974899291992188,
    0.17835080623626708984,
    -0.63775479793548583984,
    -15.816804885864257812,
    0.4419098198413848877,
    1.5007126331329345703,
    0.74311697483062744141,
    1.338045954704284668,
    1.8986225128173828125,
    5.027332305908203125,
    -0.99027097225189208984,
    -1.8959380388259887695,
    3.5703084468841552734,
    -0.93846368789672851562,
    -2.4762425422668457031,
    -1.0725769996643066406,
    -3.5743689537048339844,
    -2.8688998222351074219,
    -6.510784149169921875,
    -0.31293699145317077637,
    -0.82289367914199829102,
    3.1143937110900878906,
    1.6418554782867431641,
    1.2516322135925292969,
    1.0173343420028686523,
    2.1834938526153564453,
    1.5012600421905517578,
    24.896329879760742188,
    0.97262042760848999023,
    2.1138455867767333984,
    -10.599392890930175781,
    0.16812160611152648926,
    -0.092883065342903137207,
    0.48091098666191101074,
    1.287914276123046875,
    1.6505850553512573242,
    4.1947331428527832031,
    0.010073362849652767181,
    -0.58380228281021118164,
    -4.1666731834411621094,
    -0.39895606040954589844,
    -0.93810129165649414062,
    -2.2334139347076416016,
    -2.3862049579620361328,
    -3.9466919898986816406,
    0.47563341259956359863,
    0.66377478837966918945,
    2.5358562469482421875,
    0.28367850184440612793,
    1.0094879865646362305,
    1.0280179977416992188,
    1.6602689027786254883,
    0.91079485416412353516,
    0.49524274468421936035,
    5.9850893020629882812,
    -0.56594854593276977539,
    -0.47127678990364074707,
    31.48542022705078125,
    -2.3617510795593261719,
    -2.3440697193145751953,
    0.52674883604049682617,
    -2.7996814250946044922,
    -1.7261021137237548828,
    -0.20240232348442077637,
    6.670196533203125,
    6.6622223854064941406,
    -7.8872084617614746094,
    -3.8435199260711669922,
    -2.3713185787200927734,
    1.7818397283554077148,
    -3.3696930408477783203,
    -3.0727162361145019531,
    -27.128261566162109375,
    -5.5358529090881347656,
    -24.307470321655273438,
    -1.4807364940643310547,
    1.6738600730895996094,
    8.8022317886352539062,
    -2.4732921123504638672,
    -3.7885806560516357422,
    -8.2870721817016601562,
    -1.9088937044143676758,
    1.7087900638580322266,
    5.0860247611999511719,
    -5.2389235496520996094,
    1.2824332714080810547,
    -0.033442661166191101074,
    -0.35937091708183288574,
    -0.27876374125480651855,
    0.73882669210433959961,
    11.212290763854980469,
    0.044013135135173797607,
    0.21106618642807006836,
    -13.742707252502441406,
    -2.7391483783721923828,
    0.92346876859664916992,
    -7.5409498214721679688,
    0.19300509989261627197,
    -2.371387481689453125,
    -0.28329715132713317871,
    -1.5611304044723510742,
    -4.9302988052368164062,
    -6.5480513572692871094,
    -2.7598834037780761719,
    -1.192284703254699707,
    10.626373291015625,
    0.028265442699193954468,
    2.8626093864440917969,
    5.8466916084289550781,
    -3.9389622211456298828,
    11.233408927917480469,
    0.62214255332946777344,
    -0.63914316892623901367,
    -2.5599155426025390625,
    -1.2440631389617919922,
    3.3655962944030761719,
    1.4819757938385009766,
    -2.9899675846099853516,
    1.8236167430877685547,
    6.7675232887268066406,
    19.907405853271484375,
    -0.54130780696868896484,
    -0.93970304727554321289,
    1.7868442535400390625,
    1.4589147567749023438,
    -4.4159679412841796875,
    4.2946562767028808594,
    0.65609568357467651367,
    -1.6769282817840576172,
    -66.485504150390625,
    1.8089470863342285156,
    0.16146171092987060547,
    -3.2187676429748535156,
    1.0744761228561401367,
    6.8871002197265625,
    35.401851654052734375,
    -3.5488142967224121094,
    -8.6701908111572265625,
    3.7558276653289794922,
    1.3123688697814941406,
    0.18456929922103881836,
    -1.1234672069549560547,
    0.62557697296142578125,
    0.64825081825256347656,
    0.9314753413200378418,
    3.311161041259765625,
    -0.93276548385620117188,
    21.62375640869140625,
    -1.9972537755966186523,
    1.4184447526931762695,
    4.6493062973022460938,
    -0.29220700263977050781,
    -0.76765114068984985352,
    -1.6955667734146118164,
    -4.9312481880187988281,
    -1.3419648408889770508,
    65.47447967529296875,
    -1.7047594785690307617,
    -1.5056927204132080078,
    -10.947423934936523438,
    3.7587544918060302734,
    2.5412504673004150391,
    -22.877889633178710938,
    3.9844610691070556641,
    -0.8315887451171875,
    -21.370843887329101562,
    -0.83011847734451293945,
    -1.2104249000549316406,
    -0.38354313373565673828,
    -0.64970749616622924805,
    -1.3866016864776611328,
    -3.9141507148742675781,
    -2.2797682285308837891,
    -5.2423853874206542969,
    -0.99394387006759643555,
    -0.73163974285125732422,
    -1.2370996475219726562,
    12.940874099731445312,
    -1.792470097541809082,
    -0.33652928471565246582,
    -3.3414330482482910156,
    -3.5050110816955566406,
    1.5906691551208496094,
    -15.17812347412109375,
    -2.0947158336639404297,
    2.7277917861938476562,
    -15.760211944580078125,
    1.366579890251159668,
    -1.0047219991683959961,
    -28.8792572021484375,
    -0.59356683492660522461,
    -2.1269609928131103516,
    -1.1068530082702636719
  };
  static const double b0[] = {
    -0.75182288885116577148,
    -1.8970829248428344727,
    -0.61699110269546508789,
    -2.0117282867431640625,
    -0.84620440006256103516,
    0.99308794736862182617,
    -0.1326144486665725708,
    -2.6075778007507324219,
    0.70941466093063354492,
    -0.098203822970390319824
  };
  static const double a1[] = {
    18.048374176025390625,
    2.3557789325714111328,
    0.36531946063041687012,
    0.70407879352569580078,
    0.26705884933471679688,
    -24.0979766845703125,
    -4.1532416343688964844,
    0.63913482427597045898,
    -0.44738063216209411621,
    -13.128470420837402344,
    10.136008262634277344,
    -3.6240475177764892578,
    -0.94527208805084228516,
    -2.4859449863433837891,
    -1.8104518651962280273,
    0.76379942893981933594,
    3.1885530948638916016,
    0.91391611099243164062,
    -0.55158412456512451172,
    2.0018434524536132812,
    2.3780691623687744141,
    2.5274722576141357422,
    0.71970319747924804688,
    -0.20732514560222625732,
    0.63101148605346679688,
    -4.4636187553405761719,
    4.8384480476379394531,
    0.49798247218132019043,
    -0.72093373537063598633,
    0.54042440652847290039,
    -16.24603271484375,
    -1.6764881610870361328,
    -3.3751721382141113281,
    -2.1174535751342773438,
    -0.81206589937210083008,
    -1.8936144113540649414,
    12.545947074890136719,
    0.13250018656253814697,
    -0.87970513105392456055,
    17.483997344970703125,
    1.4922087192535400391,
    -0.47694447636604309082,
    -0.43705224990844726562,
    -0.68041884899139404297,
    0.15043854713439941406,
    1.4681508541107177734,
    -0.81243371963500976562,
    -0.81969863176345825195,
    -1.6264319419860839844,
    2.8479473590850830078,
    -1.2051215171813964844,
    -2.6744599342346191406,
    0.048000920563936233521,
    -1.2008613348007202148,
    -1.3940088748931884766,
    -0.50304681062698364258,
    -0.19392712414264678955,
    -0.61381995677947998047,
    0.11531702429056167603,
    1.9253816604614257812,
    -3.4816493988037109375,
    -3.8787121772766113281,
    0.17606653273105621338,
    -2.0726556777954101562,
    2.9665069580078125,
    -2.4179103374481201172,
    7.5435709953308105469,
    -2.4027535915374755859,
    -2.3591692447662353516,
    5.4321761131286621094,
    30.869384765625,
    1.29602813720703125,
    -0.13929691910743713379,
    0.89110648632049560547,
    -0.069836355745792388916,
    -11.938282966613769531,
    -8.4707231521606445312,
    -0.070269420742988586426,
    -1.043162226676940918,
    -11.486927032470703125,
    2.9358174800872802734,
    -0.47453290224075317383,
    -0.34640985727310180664,
    -0.57195943593978881836,
    0.5735918879508972168,
    4.1672015190124511719,
    0.064334057271480560303,
    -0.9643834233283996582,
    -1.5721803903579711914,
    0.62323755025863647461,
    -7.0484628677368164062,
    1.9899450540542602539,
    0.80512332916259765625,
    -0.11796263605356216431,
    0.88507765531539916992,
    -14.723704338073730469,
    6.0103082656860351562,
    -0.2221530228853225708,
    0.020441021770238876343,
    9.4293689727783203125
  };
  static const double b1[] = {
    -1.1176813840866088867,
    0.32913088798522949219,
    -0.90371531248092651367,
    0.85536074638366699219,
    -0.23894579708576202393,
    0.93239802122116088867,
    -1.1682407855987548828,
    -1.8343483209609985352,
    -0.42811372876167297363,
    -0.29305702447891235352
  };
  static const double a2[] = {
    -0.53129744529724121094,
    0.95264071226119995117,
    -0.48878508806228637695,
    0.90291702747344970703,
    0.70886987447738647461,
    0.65692418813705444336,
    1.3763215541839599609,
    -1.2813203334808349609,
    0.91326963901519775391,
    -0.46604308485984802246
  };
  static const double b2[] = {
    0.32662999629974365234
  };


  double w[HM];
  double o[HM];
  for (int i = 0; i < H0; ++i) {
    o[i] = b0[i];
    for (int j = 0; j < DIM; ++j) {
      o[i] += a0[i * DIM + j] * u[j];
    }
  }

  for (int i = 0; i < H0; ++i) {
    w[i] = Sig(o[i]);
  }
  for (int i = 0; i < H1; ++i) {
    o[i] = b1[i];
    for (int j = 0; j < H0; ++j) {
      o[i] += a1[i * H0 + j] * w[j];
    }
  }


  for (int i = 0; i < H1; ++i) {
    w[i] = Sig(o[i]);
  }
  for (int i = 0; i < 1; ++i) {
    o[i] = b2[i];
    for (int j = 0; j < H1; ++j) {
      o[i] += a2[j] * w[j];
    }
  }

  return o[0];
}


/*
#include <stdio.h>

int main() {
  static const double u[] = {
    0.1915194503788922864,
    0.62210877103983186487,
    0.43772773900711448025,
    0.78535858371376920939,
    0.77997580811880351526,
    0.27259260528264162016,
    0.27646425514309669325,
    0.80187217753501927042,
    0.95813935368370517498,
    0.87593263474209470676,
    0.35781726995786666823,
    0.50099512552345870642,
    0.68346293517213629887,
    0.71270202698290019416,
    0.37025075479039493143,
    0.56119618606562493568,
    0.50308316530780972098,
    0.013768449590682241279,
    0.77282662161237403176,
    0.88264119063611656824,
    0.36488598390137227945,
    0.6153961784334937013,
    0.075381241642976548611,
    0.36882400600197451368,
    0.93314010198252161921,
    0.65137814322657738852,
    0.39720257772615419345
  };

  double e = Eval(u);
  printf("c     : %.30g\n", e);
}
*/

