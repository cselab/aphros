# General config

# 0: Cubism, 1: Local
set int loc 0

set int CHECKNAN 0

# ranks 
set int px 2
set int py 2
set int pz 1

# blocks per rank
set int bx 1
set int by 1
set int bz 2

# cells per block
set int bsx 16
set int bsy 16
set int bsz 16

# domain
set double extent 1.
set int dim 3

# time step
set double dt0 1e-6
set double dtmax 1e10
set double cfl 1.
set double cfla 0.5
set double cflst 2.
set int max_step 1000000

# solvers
set int enable_fluid 1
set int enable_advection 1
set int enable_surftens 1

# convergence
set double tol 1e-3
set int max_iter 2
set int min_iter 1
set double abortvel 1e10     # abort if exceeded by velocity magnitude

# numerical
set double prelax 0.9
set double vrelax 0.8
set double rhie 1.
set int second_order 1
set int vfsmooth 0
set int inletflux_numid 1
set double stdiag 1.
set int clip_vf 0
set int simpler 0
set string conv imp
set string convsc quick
set double convdf 1.
set double kslip 0.
set double guessextra 0.

# moving mesh
#set string meshvel_auto v
#set double meshvel_weight 0.5
#set vect meshvel_mask 1 0 0

# advection
set string advection_solver vof
set double sharp 0.
set double sharpo 0.
set int split 0

# particles vof
set int part 1
set double part_relax 0.5
set double part_h 4.
set double part_kstr 1.
set double part_kattr 1.
set double part_kbend 1.
set int part_k 1
set int part_bendmean 1
set double poly_intth 0
set double part_intth 1e-6
set int part_itermax 20
set double part_tol 1e-5
set int part_constr 1      # exact constraints
set double clipth 1e-10
set double part_segcirc 0. # factor for circular segment
set int part_ns 3
set int part_np 7
set int part_verb 0
set int vof_verb 0
set double part_tmax 180.   # total angle for string [deg]
set double part_dtmax 10.   # difference in theta at one iteration [deg]
set double part_anglim 120.  # skip interface segment
                             # if exceeded by angle with string [deg]
set int part_dn 0  # normal displacement
set double part_maxr 0
set string part_attrforce line
set string part_attrreconst line

# physical
set double mu1 0.01
set double mu2 0.01
set double rho1 1.
set double rho2 1.
set vect force 0 0 0
set vect gravity 0 0 0

# surface tension
set string surftens kn
set int curvgrad 0
set double zerostx0 1e10   # decay of surface tension withing range [x0,x1]
set double zerostx1 1e10
# initial sigma field
set string init_sig uniform
set double sigma 0.
set double sig_k 1.25
set int marangoni 0
set int youngbc 0

# vof: reflection at boundaries
set int bcc_reflect 0
set double bcc_fill 0

# fixed pressure point
#set double pfixed 0
#set vect pfixed_x 0. 0. 0.

# initial velocity
set string vel_init zero

# initial volume fraction
set string init_vf zero
set int vf_init_sm 0
set string list_path b.dat
set int list_ls 1

# source from volume fraction
set double source_mag 0.   # magnitude [1/time]
#set double source_freq 1.   # frequency [1/time]
#set double source_wly 1.   # wavelength in y [length]
set double source_mag0 0.   # magnitude, constant component [1/time]
set double source_mexp 0   # exponent for factor (m2/m20)^mexp
set double source_mexp0 0   # exponent for factor (m2/m20)^mexp0

# force from volume fraction
set double force_mag 0.   # magnitude [1/time]
#set double force_freq 1.   # frequency [1/time]
#set double force_wly 1.   # wavelength in y [length]

# vortex ring
set int initvort 0
#set string vel_init vortexring
set vect ring_c 0.5 0.5 0.5
set vect ring_n 1. 0. 0.
set double ring_om 0.01
set double ring_r0 0.2
set double ring_r1 0.4

set int vort_report 1
set int linreport 0
set double hypre_vort_tol 1e-6
set string hypre_vort_solver smg
set int hypre_vort_maxiter 1000

# bubble generation
set int enable_bubgen 0
set string bubgen_path bg.dat
set double bubgen_t0 0
set double bubgen_per 1

# communication
set int hl 2
set int comm_size 8

# color
set int enable_color 0    # bubble tracker
set double color_th 0.5 
set double color_maxr 1e10

# shell averaging around bubbles
# requires enable_color=true
# shell total radius: rr * req + r
set int enable_shell 0
set double shell_h 3    # shell thickness in cells
set double shell_rr 2   # shell inner radius relative to equivalent radius
set double shell_r 0    # shell inner radius absolute

# linear solver
#set string hypre_symm_solver pcg+smg
#set string hypre_symm_solver smg
set string hypre_symm_solver pcg
set int hypre_symm_maxiter 100
set string hypre_gen_solver gmres
set int hypre_gen_maxiter 30

set int hypre_periodic_x 0
set int hypre_periodic_y 0
set int hypre_periodic_z 0
set int hypre_print 0
set double hypre_symm_tol 1e-3
set double hypre_gen_tol 1e-3

set int loc_periodic_x 1
set int loc_periodic_y 1
set int loc_periodic_z 1

set string bc_xm wall 0 0 0
set string bc_xp wall 0 0 0
set string bc_ym wall 0 0 0
set string bc_yp wall 0 0 0 
set string bc_zm wall 0 0 0
set string bc_zp wall 0 0 0

set int bc_wall_init_vel 0

# pois
set int poiswym 1
set int poiswyp 1
set int poiswzm 1
set int poiswzp 1

# output field
set int output 1
set double dump_field_t0 0.
set double dump_field_dt 1
set int dump_field_max 10000
set int dumpinit 0
set string dumplist vx vy vz p vf cl 

# timer report
set double dump_trep_t0 0.
set double dump_trep_dt 1
set int dump_trep_max 10000

# debug output
set int report_knan 0  # nan curvature
set int report_stat 0  # field statistics 

# output traj
set double dump_traj_t0 0.
set double dump_traj_dt 1
set int dump_traj_max 10000

# output vof 
set int dumppoly 1
set int dumppart 0
set int dumppartinter 0
set double dump_part_t0 0.
set double dump_part_dt 1
set int dump_part_max 10000
set int part_dump_fr 1
set int part_report_fr 1

# output stat
set int dump_stat_max 1000000
set double dump_stat_dt 0
set string dumpformat default
set int verbose 0
set int verbose_stages 1
set int statvel 0
set int enstrophy 0
set int stat_area 0
set int stat_dissip 0

# box stat
set int statbox 0
set vect statboxa 0 0 0.5
set vect statboxb 1 1 0.5
set vect statbox2a 0 0 0.5
set vect statbox2b 1 1 0.5

