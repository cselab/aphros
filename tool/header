#!/bin/sh

find . -type f -name '*.h' |
awk -v me="$0" '
BEGIN {
    print "# generated by " me
}

{
    sub(/^\.\//, "")
    if (/^test\//) next
    printf "install(FILES %s DESTINATION ${CHPREFIX}/include/hydro/%s)\n",
        $0, dirname($0) | "sort"
}

function dirname(s)
{
    sub(/\/.*/, "", s)
    return s
}

' > header.cmake

echo >&2 "update header.cmake"
